Full waveform inversion (FWI)~\cite{FWI0,FWI1} aims to reconstruct subsurface properties from observed seismic data.
Subsurface properties are used for geological research and resource exploration, including gas, oil, mineral deposits, and groundwater~\cite{FWI1,FWIApplicationGroundwater0,FWIApplicationGroundwater1}.
FWI has also been applied to non-destructive testing~\cite{FWIApplicationNonDestructiveTesting0,FWIApplicationNonDestructiveTesting1}.

Since the observed seismic data are generated by subsurface properties, FWI is formulated as an inverse problem.
However, it is ill-posed, and the quality of the solution depends significantly on the initial model~\cite{FWI1}.
To achieve accurate reconstruction, several formulations have been proposed~\cite{FWI0,CustomFWI0,CustomFWI1,CustomFWI2,CustomFWI3,CustomFWI4,CustomFWI5}.
Typically, FWI is treated as an optimization problem, where the objective is to minimize the squared error between observed and modeled data.

To enhance stability and accuracy, regularization terms are often added to the objective function, such as Tikhonov regularization~\cite{tikhonov}, Total Variation (TV)~\cite{TV}, and Total Generalized Variation (TGV)~\cite{TGV}.
For example, studies have used regularization of Tikhonov~\cite{FWI-with-tikhonov-regularization}, TV~\cite{FWI-with-TV-regularization}, directional TV~\cite{FWI-with-directional-TV-regularization}, high-order TV~\cite{FWI-with-high-order-TV-regularization}, and TGV~\cite{FWI-with-TGV-regularization}.

The value of the objective function of FWI depends on the observation method, such as a type of input signal and the number of observation equipment, because it contains the squared error between the observed data and the modeled data.
Consequently, the regularization parameters must be adapted to the observation method.
On the other hand, adding constraints to the objective function is advantageous because its parameters can only be derived from prior knowledge of the subsurface properties~\cite{constraints-vs-penalties-in-FWI}.
Therefore, it has been proposed to add the TV constraint to the objective function~\cite{FWI-with-TV-constraint,FWI-with-TV-constraint2,FWI-with-TV-constraint3}.

In conventional methods that apply the TV constraint to FWI~\cite{FWI-with-TV-constraint,FWI-with-TV-constraint2}, parameter updates amount in one step of optimization algorithms are adjusted to satisfy the constraints.
This often requires an additional optimization, resulting in an inner loop and increased computational cost.
In addition, approximations are introduced to incorporate constraints, such as treating non-linear transformations as linear or imposing constraints outside the optimization method.

In this paper, we develop an efficient algorithm to solve the optimization problem of the constrained FWI. Our contributions are as follows:
\begin{enumerate}
      \item We propose a novel algorithm based on the primal-dual splitting (PDS) method to solve the TV and box constrained FWI problem.
            This method eliminates the need for an inner optimization loop and approximations that are common in conventional approaches.
      \item We demonstrate that our algorithm efficiently handles constraints while maintaining computational feasibility, with no significant increase in computational cost, and that it achieves accurate reconstruction.
      \item The PDS framework is flexible and allows for the integration of more complex constraints and regularizations, making it a valuable tool for further development in FWI.
\end{enumerate}


