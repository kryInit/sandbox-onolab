Full waveform inversion (FWI)~\cite{FWI0,FWI1} is a task that aims to reconstruct subsurface properties from observed seismic data.
These subsurface properties are used for geological research and resource exploration, including deposits of gas, oil, mineral, and groundwater~\cite{FWI1,FWIApplicationGroundwater0,FWIApplicationGroundwater1}.
In addition to resource exploration, FWI has also been successfully applied to non-destructive testing~\cite{FWIApplicationNonDestructiveTesting0,FWIApplicationNonDestructiveTesting1}.

FWI is an ill-posed problem, and observed seismic data are generated by subsurface properties through a nonlinear and complex observation process~\cite{FWI1}.
To address this, FWI is formulated as an optimization problem~\cite{FWI0,CustomFWI0,CustomFWI1,CustomFWI2,CustomFWI3,CustomFWI4,CustomFWI5} such as minimizing the squared error between observed and modeled data.
However, accurately reconstructing subsurface properties by solving the problem remains challenging due to the nonlinearity of the observation process and the ill-posed nature of the problem.
To improve the accuracy, many studies have introduced regularization techniques~\cite{FWI-with-tikhonov-regularization,FWI-with-TV-regularization,FWI-with-directional-TV-regularization,FWI-with-high-order-TV-regularization,FWI-with-TGV-regularization}, such as Tikhonov~\cite{tikhonov} and Total Variation (TV)-type~\cite{TV,TGV} regularization, based on the prior knowledge that subsurface properties exhibit piecewise smoothness.

However, regularizations often require careful tuning of balance parameters to trade off between data fitting and smoothness.
In contrast to regularizations, constraints are advantageous because their parameters can be determined based only on prior knowledge of the subsurface properties~\cite{constraints-vs-penalties-in-FWI}.
Formulating the problem with constraints not only simplifies parameter selection but also makes the problem and solution more interpretable, which is beneficial for practical applications.
Therefore, it has also been proposed to incorporate TV as a constraint into the problem~\cite{FWI-with-TV-constraint,FWI-with-TV-constraint2,FWI-with-TV-constraint3}.

However, the TV-constrained the problem is difficult to solve not only because of the nonlinearity of the observation process, but also because of the non-smoothness of the TV constraint.
As a result, in conventional methods to solve it~\cite{FWI-with-TV-constraint,FWI-with-TV-constraint2,FWI-with-TV-constraint3}, parameter updates amount in each step of an iterative optimization algorithm are adjusted to satisfy the constraint.
This requires an additional optimization, resulting in an inner loop and increased computational cost.
In addition, approximations are introduced to incorporate the constraint, such as treating nonlinear transformations as linear and imposing constraints outside the optimization method.

If the TV-constrained the problem could be solved with neither an inner loop nor these approximations, more efficient and accurate reconstructions of subsurface properties would be possible.
In this paper, we propose a novel algorithm to solve the problem based on the primal-dual splitting (PDS) method, which eliminates the need for an inner loop and approximations that are common in conventional approaches.
We demonstrate that our algorithm efficiently handles constraints without significantly increasing the computational cost, while achieving accurate reconstruction.





