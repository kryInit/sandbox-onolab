Full waveform inversion (FWI)~\cite{FWI0,FWI1} aims to reconstruct subsurface properties from seismic data observed at multiple points.
These subsurface properties are used for geological research and resource exploration, including deposits of gas, oil, mineral, and groundwater~\cite{FWI1,FWIApplicationGroundwater0,FWIApplicationGroundwater1}.
In addition to geological fields, FWI has also been successfully applied to non-destructive testing~\cite{FWIApplicationNonDestructiveTesting0,FWIApplicationNonDestructiveTesting1}.

The observation process of seismic data from subsurface properties is nonlinear and complex~\cite{FWI1}, making an analytic inverse transformation infeasible.
To address this, an effective approach is to formulate FWI as an optimization problem~\cite{FWI0,CustomFWI0,CustomFWI1,CustomFWI2,CustomFWI3,CustomFWI4,CustomFWI5} such as minimizing the squared error between observed and modeled seismic data.
Since FWI is an ill-posed inverse problem, regularization techniques are also effective.
To capture the piecewise smoothness of subsurface properties, Tikhonov~\cite{tikhonov} and Total Variation (TV)-type~\cite{TV,TGV} regularizations have been introduced~\cite{FWI-with-tikhonov-regularization,FWI-with-TV-regularization,FWI-with-directional-TV-regularization,FWI-with-high-order-TV-regularization,FWI-with-TGV-regularization}.
However, these regularizations often require careful tuning of balance parameters.

Instead of regularizations, it has also been proposed to incorporate TV as a constraint into the FWI problem~\cite{FWI-with-TV-constraint,FWI-with-TV-constraint2,FWI-with-TV-constraint3}.
In contrast to the TV regularization, the TV constraint has the advantage that its parameters can be determined based only on prior knowledge of the subsurface properties~\cite{constraints-vs-penalties-in-FWI}.
This makes the parameters easier to interpret, as they provide direct control over the smoothness of the solution, which is particularly beneficial for practical applications.

However, the TV-constrained FWI problem is difficult to solve not only because of the nonlinearity of the observation process, but also because of the non-smoothness of the TV constraint.
To address this, conventional methods~\cite{FWI-with-TV-constraint,FWI-with-TV-constraint2,FWI-with-TV-constraint3} adjust the objective variable to satisfy the constraint at each step of an iterative optimization algorithm.
This requires an inner loop, which results in high computational cost.
In addition, approximations are introduced, such as treating nonlinear transformations as linear and satisfying constraints outside the optimization method.
If the TV-constrained FWI problem could be solved with neither an inner loop nor these approximations, more efficient and accurate reconstructions of subsurface properties would be possible.

In this paper, we propose a novel algorithm to solve the TV-constrained FWI problem based on the primal-dual splitting (PDS) method.
Our algorithm addresses the challenges posed by both the nonlinearity of the observation process and the non-smoothness of the TV constraint without approximations, resulting in a more accurate reconstruction.
Furthermore, it can handle the constraint without an inner loop, which enhances computational efficiency.
We demonstrate that our algorithm efficiently handles the constraint while achieving accurate reconstruction.

