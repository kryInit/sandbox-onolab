As shown in Fig.\ref{fig:salt-model}, the velocity model of the Salt is piecewise smooth.
Therefore, we introduce the TV constraint to achieve more accurate reconstruction.
Also, by introducing the box constraint, we can ensure that the velocity model does not take invalid values, and we show the flexibility of incorporating constraints using PDS.

We minimize the objective function of the TV and box constrained FWI, which is expressed as follows:
\begin{equation} \label{eq:FWIObjectiveWithTVConstraint} \argmin{\velModel \in \realNumber^N} \ \ \FWIObjectiveWithTVConstraint \end{equation}
where $\alpha \in \realNumber$ is the upper bound of the $l_{1,2}$ norm, and $a, b \in \realNumber$ are the lower and upper bounds of the velocity model value, respectively.

The constraints can be incorporated into the objective function as indicator functions:
\begin{equation} \label{eq:FWIObjectiveWithTVConstraintWithIndicatorFunction} \argmin{\velModel \in \realNumber^N} \ \ \FWIObjectiveWithTVConstraintWithIndicatorFunction \end{equation}

As mentioned in Section~\ref{subsec:mathematical-tools}, $\iota_{\LOneTwoNorm{\cdot} \le \alpha}$ and $\iota_{[a,b]^N}$ can be computed efficiently\eqref{eq:ProximityOperatorForL1Ball}\eqref{eq:ProximityOperatorForL12Ball}.
Therefore, these functions of $E$, $\iota_{[a,b]^N}$ and $\iota_{\LOneTwoNorm{\cdot} \le \alpha}$ correspond to $f$, $g$ and $h$ in \eqref{eq:PDSPrimalEq}, respectively, $\diffOperator$ is corresponds to $\bm{L}$, and the problem~\eqref{eq:FWIObjectiveWithTVConstraintWithIndicatorFunction} can be solved using PDS.
The iterative procedures are as follows:
\begin{equation} \label{eq:FWIWithPDS} \FWIWithPDS \notag \end{equation}


Below is the proximity operator for the specific function used in this paper.
\begin{equation} \label{eq:ProximityOperatorForBoxConstraint} \projBoxSolution. \end{equation}

%The proximity operator for the $l_{1,2}$ norm upper bound constraint is expressed as follows~\cite{L12-ball-projection}:
\begin{equation} \label{eq:ProximityOperatorForL12Ball} \projLOneTwoBallSolution, \end{equation}
where
\begin{equation} \label{eq:ProximityOperatorForL12BallWhere} \projLOneTwoBallSolutionWhere \notag \end{equation}

%The proximity operator for the $l_1$ norm upper bound constraint is expressed as follows~\cite{L1-ball-projection}(faster algorithms are also proposed~\cite{fast-L1-ball-projection}):
\begin{equation} \label{eq:ProximityOperatorForL1Ball}  \projLOneBallSolution, \end{equation}
where
\begin{equation} \label{eq:ProximityOperatorForL1BallWhere} \projLOneBallSolutionWhere \notag \end{equation}

The proof of equations~\eqref{eq:ProximityOperatorForL1Ball} and~\eqref{eq:ProximityOperatorForL12Ball} can be found in~\cite{L1-ball-projection}, and~\cite{L12-ball-projection}, respectively.
A faster algorithm than~\eqref{eq:ProximityOperatorForL1Ball} has been developed~\cite{fast-L1-ball-projection}.

