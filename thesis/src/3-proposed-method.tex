We introduce the TV and box constraint into the FWI problem to achieve more accurate reconstruction.
As shown in Fig.~\ref{fig:salt-model}, the velocity model is piecewise smooth, thus introducing the TV constraint to achieve a more accurate reconstruction.
Also, by introducing the box constraint, we prevent the velocity model values from being invalid.
As mentioned in the introduction, it is easier to determine parameters if the TV is treated as a constraint rather than a regularization.

The optimization problem of the TV and box constrained FWI is formulated as follows:
\begin{equation} \label{eq:FWIObjectiveWithTVConstraint} \argmin{\velModel \in \realNumber^N} \ \ \FWIObjectiveWithTVConstraint \end{equation}
where $\alpha \in \realNumber$ is the upper bound of the $l_{1,2}$ norm, and $a, b \in \realNumber$ are the lower and upper bounds of the velocity model values, respectively.

The constraints can be incorporated into the objective function as indicator functions:
\begin{equation} \label{eq:FWIObjectiveWithTVConstraintWithIndicatorFunction} \argmin{\velModel \in \realNumber^N} \ \ \FWIObjectiveWithTVConstraintWithIndicatorFunction. \end{equation}

The proximity operator of $\iota_{\LOneTwoNorm{\cdot} \le \alpha}$ and $\iota_{[a,b]^N}$ can be computed efficiently.
Therefore, these functions of $E$, $\iota_{[a,b]^N}$ and $\iota_{\LOneTwoNorm{\cdot} \le \alpha}$ correspond to $f$, $g$ and $h$ in \eqref{eq:PDSPrimalEq}, respectively, $\diffOperator$ is corresponds to $\bm{L}$, and the problem~\eqref{eq:FWIObjectiveWithTVConstraintWithIndicatorFunction} can be solved using PDS.
We show the detailed algorithm in Algorithm~\ref{alg:FWIWithPDS}.
%\begin{equation} \label{eq:FWIWithPDS} \FWIWithPDS \notag \end{equation}
\begin{algorithm}[t]
    \caption{PDS for \eqref{eq:FWIObjectiveWithTVConstraintWithIndicatorFunction}}\label{alg:FWIWithPDS}
    \begin{algorithmic}[1]
        \Statex \textbf{Input:} $ \velModel^{(0)}, \vecy^{(0)}, \gamma_0 > 0, \gamma_1 > 0 $
        \While {A stopping criterion is not satisfied}
            \State $\widetilde{\velModel} \leftarrow \FWIWithPDSStepMTmp $
            \State $\velModel^{(k+1)}     \leftarrow \FWIWithPDSStepM $
            \State $\widetilde{\vecy}     \leftarrow \FWIWithPDSStepYTmp $
            \State $\vecy^{(k+1)}         \leftarrow \FWIWithPDSStepY $
        \EndWhile
        \Statex \textbf{Output:} $\velModel^{(k)}$
    \end{algorithmic}
\end{algorithm}



The following are the proximity operators of indicator function of the box constraint and the $l_{1,2}$ norm upper bound constraint.
\begin{equation} \label{eq:ProximityOperatorForBoxConstraint} \projBoxSolution. \end{equation}

%The proximity operator for the $l_{1,2}$ norm upper bound constraint is expressed as follows~\cite{L12-ball-projection}:
\begin{equation} \label{eq:ProximityOperatorForL12Ball} \projLOneTwoBallSolution, \end{equation}
where
\begin{equation} \label{eq:ProximityOperatorForL12BallWhere} \projLOneTwoBallSolutionWhere \notag \end{equation}

The proximity operator for the $l_1$ norm upper bound constraint is expressed as follows~\cite{L1-ball-projection}:
\begin{equation} \label{eq:ProximityOperatorForL1Ball}  \projLOneBallSolution, \end{equation}
where
\begin{equation} \label{eq:ProximityOperatorForL1BallWhere} \projLOneBallSolutionWhere \notag \end{equation}

The computation of $\nabla E$ requires the simulation of the wave equation along the time axis for each grid point.
In contrast, the computation of the other parts of the process can be done without time axis simulations.
Therefore, the computationally intensive part of the process is primarily the calculation of $\nabla E$, and the introduction of the constraints does not significantly increase the overall computational cost.
