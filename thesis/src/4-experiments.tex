\subsection{Experimental Setup}\label{subsec:experimental-setup}
%
%推定したい真のvelocity modelは101 x 51のgrid pointsで構成されます.
%初期velocity modelは、真のvelocity modelを標準偏差は80のガウス関数で平滑化したものを使用します.
%source waveletは10 Hzの主周波数を持つRicker waveletを使用します.
%shot数とreceiver数はそれぞれ101と20です.
%勾配Eの計算はdevitoを用いて行われました.
%
%the velocity model is composed of 101 and 51 grid points in the horizontal and vertical directions, respectively.
%We use source wavelet that a Ricker wavelet with a dominant frequency of 10 Hz as the source wavelet.
%number of shots and the receivers are 101 and 20, respectively.
%the initial model obtained by smoothing the velocity model with a Gaussian smoothed function where the standard deviation is 80.
%
To demonstrate the effectiveness of the TV and box constrained FWI, we conducted experiments where we compared with the standard FWI with gradient method~\eqref{eq:FWIWithGradient}, using the SEG/EAGE Salt and Overthrust Models.
The velocity model consists of 101 $\times$ 51 grid points.
The ground truth velocity model is generated by zooming and cropping fig.\ref{fig:salt-model}, and the initial velocity model is generated by smoothing the ground truth velocity model with a Gaussian function with a standard deviation of 80.
The number of receivers and source shots are 101 and 20, respectively, and are placed on the surface at equal intervals.
The source waveform is a Ricker wavelet with a peek wavelet frequency of 10 Hz.
The gradient of $E$ is computed numerically using the Devito framework\cite{devito}.
In standard FWI, the step size $\gamma$ is set to $1.0 \times 10^{-4}$.
In the TV and box constrained FWI, the step size $\gamma_1$ and $\gamma_2$ are set to $1.0 \times 10^{-4}$ and $1.0 \times 10^2$, respectively, the upper bound of the $l_{1,2}$ norm $\alpha$ is set to 340 and the lower and upper bounds of the velocity model $a$, $b$ are set to 1.5[km/s] and 4.5[km/s], respectively.
The number of iterations is set to 5000.


\begin{figure*}[htbp]
    \centering
    \begin{tabular}{m{68mm} m{70mm} m{10mm}}
        % First row: Image 1, 2, and vertically spanning Image 5
        \begin{minipage}[b]{70mm}
            \centering
            \includegraphics[width=70mm]{public/true}
            \caption*{\raisebox{5mm}{Background truth}}
        \end{minipage} &
        \begin{minipage}[b]{70mm}
            \centering
            \includegraphics[width=70mm]{public/gradient}
            \caption*{\raisebox{5mm}{Reconstructed with standard FWI}}
        \end{minipage} &
        \multirow[t]{2}{*}{\raisebox{-50mm}{\includegraphics[height=68mm]{public/color-bar}}} \\
        % Second row: Image 3 and 4
        \begin{minipage}[b]{70mm}
            \centering
            \includegraphics[width=70mm]{public/initial}
            \caption*{Initial model}
        \end{minipage} &
        \begin{minipage}[b]{70mm}
            \centering
            \includegraphics[width=70mm]{public/pds}
            \caption*{Reconstructed with the constrained FWI}
        \end{minipage} &
    \end{tabular}
    \caption{Velocity models and their corresponding reconstructions.}
    \label{fig:velocity-models}
\end{figure*}



\subsection{Results and Discussion}\label{subsec:results-and-discussion}

Fig.\ref{fig:velocity-models} presents the ground truth, the initial model, and the reconstructed velocity models using the standard FWI and the TV and box constrained FWI.
It can be observed that the TV and box constrained FWI successfully eliminates wave-like artifacts and noise appearing at the source positions, resulting in a more accurate velocity model reconstruction.

In Fig.\ref{fig:ssim}, we plot the Structural Similarity Index Measure (SSIM) against the number of iterations for both methods.
The proposed method consistently achieves higher SSIM values than the standard FWI at every iteration, indicating improved reconstruction quality.

Furthermore, since the computational bottleneck lies in the gradient calculation of $E$, the introduction of the constraints does not significantly affect the overall computation time.
This demonstrates that the proposed method enhances reconstruction accuracy without incurring additional computational costs.

However, it should be noted that parameters such as $\alpha$, $a$, and $b$ were determined by referencing the ground truth data.
While this experiment shows that good results can be achieved by appropriately setting these parameters, they need to be determined independently of this framework in practical applications.


\begin{figure}[htbp]
\vspace{-\baselineskip}
\begin{center}
    \includegraphics[width=80mm]{public/ssim}
    \caption{SSIM against the number of iterations.}
    \label{fig:ssim}
\end{center}
\vspace{-\baselineskip}
\end{figure}



% TV制約を導入したFWIでは波のようなノイズやsourcesの位置に出現するノイズが消え、より正確なモデルが得られていることがわかります.
% iterations毎のssimをplotしたfig. 2では、常に提案法が正規FWIよりも高いssimを示しています.
% また、計算コストのボトルネックは勾配の計算であるため、TV制約を導入しても計算時間はほとんど変わりません.
% しかしながら、alpha, a,bなどのパラメータはground truthを見て決定されたことに注意してください.
% この実験では, 適切にパラメータを設定すれば良い結果が得られることを示していますが、そのパラメータはこの枠組みの外側で決定する必要があります.








